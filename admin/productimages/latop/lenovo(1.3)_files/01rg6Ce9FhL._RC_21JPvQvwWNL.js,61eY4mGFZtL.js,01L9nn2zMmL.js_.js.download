(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("DetailPageInstallmentCalculatorAssets",""):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){});
/* ******** */
(function(b){var g=window.AmazonUIPageJS||window.P,p=g._namespace||g.attributeErrors,a=p?p("DetailPagePriceTrackerIngressAssets",""):g;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,g,p){"use strict";b.when("price-tracker-ingress-helper").register("price-tracker-events-registrar",function(a){return{registerEventsBasedOnWeblab:function(b){a.handleFirstClickEvent(b)}}});b.register("price-tracker-ingress-latency-metrics",function(){return{METRIC_LATENCY_WIDGET:"priceTrackerWidget:assetsLoadedNonCriticalATF"}});
b.execute("price-tracker-ingress-init",function(){b.register("price-tracker-ingress-constants",function(){return{CLICK_ACTION:"click",CLICK_ACTION_ID:"show-price-tracker",MAIN_HANDLER_NAME:"price-tracker-event-handler",ASSETS_LOAD_EVENT:"priceTrackerIngressClick",CLICK_DECLARATIVE_EVENT:"priceTrackerDeclarativeEvent",ASSETS_LOADED_STATE:"priceTracker:assetsLoaded",SPINNER_ID:"price-tracker-spinner",MODAL_NAME:"price-tracker",DATA_STRATEGY:"preload",FAILURE_ID:"price-tracker-failure",MAIN_ASSETS_LOADING_TIMEOUT:3E4,
BOTTOM_SHEET_INITIAL_HEIGHT:100,BOTTOM_SHEET_CLOSE_TYPE:"icon",HIDDEN_AOK:"aok-hidden",MOBILE_STYLE:"price-tracker-style",BOTTOM_SHEET_NAME:"price-tracker",PRELOAD_DOM_ID:"price-tracker",PRELOAD_DOM_PARENT_ID:"price-tracker-parent"}});b.when("A","jQuery","price-tracker-state-handler","price-tracker-ingress-metrics","price-tracker-ingress-constants").register("price-tracker-ingress-helper",function(a,h,f,d,k){function e(c){return h("#"+c)}function n(c){return e(null!=m?c+"-"+m:c)}function q(c){l||
b.register(k.CLICK_DECLARATIVE_EVENT,function(){l=!0;return c})}var m=void 0,r=void 0,l=void 0;return{getElementBasedOnID:e,getDynamicID:function(c){return null!=m?c+"-"+m:c},getElementBasedOnDynamicID:n,updateBuyingOptionIndex:function(c){m=c},showFailureMessage:function(){n(k.FAILURE_ID).show()},logError:function(c){var a=1<arguments.length&&arguments[1]!==p?arguments[1]:null;if(g.ueLogError){var b={logLevel:"ERROR",attribution:"detail_page_price_tracker_ingress_assets",message:c+" "};a||(a=Error("No exception is thrown."));
g.ueLogError(a,b)}},registerEvent:function(c,b){if(!a.isListening(c))a.on(c,b)},triggerEventToLoadAsset:function(c){b.now().execute(function(){f.isMarkerOverrideRegistered()||(b.register(k.ASSETS_LOAD_EVENT),d.startTimer(d.METRIC_MAIN_ASSETS_LOADING_LATENCY),r=!0,q(c),f.setMarkerOverrideRegistered())})},handleFirstClickEvent:q,stopAssetsLoadedTimer:function(){r&&d.stopTimer(d.METRIC_MAIN_ASSETS_LOADING_LATENCY)}}});b.register("price-tracker-ingress-metrics",function(){return{logCountMetric:function(a){g.ue&&
g.ue.count&&g.ue.count(a,1)},startTimer:function(a){uet&&uet("bb",a,{wb:1})},stopTimer:function(a){uex&&uex("ld",a,{wb:1})},reportCriticalFeature:function(a){uet&&uet("cf",a,{wb:1})},METRIC_NULL_BUYING_OPTION:"priceTracker:buyingOption:null",METRIC_FAILED_TO_LOAD_ASSETS_WITHIN_TIMEOUT:"priceTracker:assets:loading:timeout",METRIC_ASSETS_LOADED_AFTER_TIMEOUT:"priceTracker:assets:loading:success:after:timeout",METRIC_A11Y_INGRESS_DATA_INCOMPLETE:"priceTracker:a11y:ingress:data:incomplete",METRIC_MAIN_ASSETS_LOADING_LATENCY:"priceTrackerAssetsLoading",
METRIC_DESKTOP:"priceTracker:desktop",METRIC_DESKTOP_FATAL:"priceTracker:desktop:fatal",METRIC_MOBILE:"priceTracker:mobile",METRIC_MOBILE_CHANGE_HEIGHT_FATAL:"priceTracker:mobile:changeHeight:fatal",METRIC_MOBILE_FATAL:"priceTracker:mobile:fatal"}});b.register("price-tracker-state-handler",function(){var a=!1;return{isMarkerOverrideRegistered:function(){return a},setMarkerOverrideRegistered:function(){a=!0}}});b.when("A","price-tracker-ingress-constants","price-tracker-ingress-helper","price-tracker-events-registrar",
"price-tracker-ingress-metrics","price-tracker-ingress-action-handler-helper-utils").register("price-tracker-ingress-action-handler-helper",function(a,h,f,d,k,e){function g(){return a.delay(function(){f.getElementBasedOnDynamicID(h.SPINNER_ID).hide();f.showFailureMessage();m=!0;k.logCountMetric(k.METRIC_FAILED_TO_LOAD_ASSETS_WITHIN_TIMEOUT)},h.MAIN_ASSETS_LOADING_TIMEOUT)}function q(){var a=!1;b.now(h.ASSETS_LOADED_STATE).execute(function(b){"undefined"!==typeof b&&(a=b)});return a}var m=!1;return{handle:function(a,
l){q()?b.when(h.MAIN_HANDLER_NAME).execute(function(c){e.unregisterIngressEventHandlers(l);c.renderPriceTracker(a)}):function(){d.registerEventsBasedOnWeblab(a);var c=g();b.when(h.MAIN_HANDLER_NAME,h.CLICK_DECLARATIVE_EVENT).execute(function(a,b){f.stopAssetsLoadedTimer();clearTimeout(c);m&&(f.getElementBasedOnDynamicID(h.FAILURE_ID).hide(),f.getElementBasedOnDynamicID(h.SPINNER_ID).show(),k.logCountMetric(k.METRIC_ASSETS_LOADED_AFTER_TIMEOUT));e.unregisterIngressEventHandlers(l);a.renderPriceTracker(b)})}()}}});
b.when("A").register("price-tracker-ingress-action-handler-helper-utils",function(a){return{unregisterIngressEventHandlers:function(b){a.off("a:popover:invisible:"+b)}}});b.when("A","a-modal","price-tracker-ingress-constants","price-tracker-ingress-helper","price-tracker-ingress-action-handler-helper","price-tracker-ingress-metrics","price-tracker-ingress-latency-metrics").execute(function(a,b,f,d,g,e,n){a.declarative(f.CLICK_ACTION_ID,f.CLICK_ACTION,function(a){function h(c){var d=b.get(c);d&&a.$target.data("a-popover-id",
d.id);c={name:c,dataStrategy:f.DATA_STRATEGY};a&&a.data&&a.data.priceTrackerCloseA11YLabel&&a.data.priceTrackerA11YLabel?(c.closeButtonLabel=a.data.priceTrackerCloseA11YLabel,c.popoverLabel=a.data.priceTrackerA11YLabel):e.logCountMetric(e.METRIC_A11Y_INGRESS_DATA_INCOMPLETE);d=b.create(a.$target,c);d.show()}function k(a){d.registerEvent("a:popover:invisible:"+a,function(){d.getElementBasedOnDynamicID(f.FAILURE_ID).hide()})}try{if(e.startTimer(n.METRIC_LATENCY_WIDGET),e.logCountMetric(e.METRIC_DESKTOP),
a&&a.data&&null!=a.data.buyingOptionIndex){d.updateBuyingOptionIndex(a.data.buyingOptionIndex);var l=d.getDynamicID(f.MODAL_NAME);k(l);d.getElementBasedOnDynamicID(f.SPINNER_ID).show();h(l);e.reportCriticalFeature(n.METRIC_LATENCY_WIDGET);g.handle(a,l)}else e.logCountMetric(e.METRIC_NULL_BUYING_OPTION),e.stopTimer(n.METRIC_LATENCY_WIDGET)}catch(c){e.logCountMetric(e.METRIC_DESKTOP_FATAL),d.getElementBasedOnDynamicID(f.SPINNER_ID).hide(),d.showFailureMessage(),e.stopTimer(n.METRIC_LATENCY_WIDGET),
d.logError("An error occurred while loading Price Tracker on a desktop client.",c)}})});b.when("A","a-modal","price-tracker-ingress-constants","price-tracker-ingress-helper","price-tracker-ingress-action-handler-helper","price-tracker-ingress-metrics").register("price-tracker-ingress-action-handler",function(){})})});
/* ******** */
(function(p){var g=window.AmazonUIPageJS||window.P,r=g._namespace||g.attributeErrors,d=r?r("ABPricingFreeFormQuantityPickerAssets",""):g;d.guardFatal?d.guardFatal(p)(d,window):d.execute(function(){p(d,window)})})(function(p,g,r){p.when("jQuery","A","abPricingFfqp_constants","abPricingFfqp_metrics","abPricingFfqp_amazonAPIPriceFormatter").register("abPricingFfqp_amazonAPIClient",function(d,g,f,a,c){return g.createClass({inclusions:function(){return{priceV1:"buyingOptions[].price(product.price/v1)",
quantityPricingTableV1:"buyingOptions[].quantityPricingTable(product.quantity-pricing-table/v1)",availabilityV2:"buyingOptions[].availability(product.availability/v2)"}},init:function(a){this._baseEndpoint="https://"+a.endpoint;this._baseUrl=this._baseEndpoint+"/api/marketplaces/"+a.marketplaceId+"/";this._defaultHeaders={"Accept-Language":a.language,"x-api-csrf-token":a.csrfToken,"x-cc-currency-of-preference":a.currencyOfPreference,"x-amzn-encrypted-slate-token":this._getSlateToken()};"object"===
typeof a.priceFormatConfig&&(this._aapiPriceFormatter=new c(a.priceFormatConfig));a=this._getValidatedClientId(a.clientId);this._metricScopeName=f.METRIC_SCOPE_NAME.AAPI_CLIENT.replace(f.AAPI_CLIENT_ID_PLACEHOLDER,a);this._statusMetricNameTpl=f.COUNTER_METRIC.AAPI_REQUEST_STATUS.replace(f.AAPI_CLIENT_ID_PLACEHOLDER,a)},_constructHeader:function(a,c){return"application/vnd.com.amazon.api+json; "+(""===a?"":'type\x3d"'+a+'"; ')+(""===c?"":'expand\x3d"'+c+'"; ')+'experiments\x3d"enableQuantityPricingTablePaginationField_dn2f4w34"'},
productV2:function(a){var c=["products",a.asin],f={Accept:this._constructHeader("product/v2",a.subresources.join(","))},c=this._constructUrl(c,a.parameters);this._get(a.success,a.error,c,f)},productQPT:function(a){var c={Accept:this._constructHeader("product.quantity-pricing-table/v1","")};this._get(a.success,a.error,this._baseEndpoint+a.url,c)},_getValidatedClientId:function(a){return"string"===typeof a&&0<a.length?a:f.UNSPECIFIED_CLIENT_ID},_get:function(c,m,g,l){var h=this;a.registerWidgetBodyBegin(this._metricScopeName);
l=d.extend(this._defaultHeaders,l);d.ajax({url:g,type:"GET",headers:l,xhrFields:{withCredentials:!0},timeout:f.AAPI_CLIENT_TIMEOUT}).done(function(a,e){h._handleAjaxSuccess(a,e,c)}).fail(function(a,e,t){h._handleAjaxError(e,t,m,a.status)}).always(function(a,e){h._handleAjaxComplete(e)})},_constructUrl:function(a,c){c=c||{};c=d.map(c,function(a,c){return c.toString()+"\x3d"+a.toString()}).join("\x26");return this._baseUrl+a.join("/")+(0<c.length?"?"+c:"")},_getSlateToken:function(){var a=document.querySelector('meta[name\x3d"encrypted-slate-token"]');
if(a)return a.content},_handleAjaxSuccess:function(c,f,d){this._aapiPriceFormatter&&this._aapiPriceFormatter.formatPrices(c);a.registerWidgetCriticalFeature(this._metricScopeName);a.registerWidgetLoaded(this._metricScopeName);d&&d(c,f)},_handleAjaxError:function(c,f,d,g){a.registerWidgetLoaded(this._metricScopeName);d&&d(c,f,g);c=["Error during ajax request:",g||"",c||"",f||""].join(" ");a.logError("ERROR",c)},_handleAjaxComplete:function(c){"string"!==typeof c&&(c=f.UNSPECIFIED_REQUEST_STATUS);c=
this._statusMetricNameTpl.replace(f.AAPI_REQUEST_STATUS_PLACEHOLDER,c);a.registerCounter(c)}})});"use strict";p.when("A","abPricingFfqp_constants","abPricingFfqp_metrics","abPricingFfqp_priceFormatter").register("abPricingFfqp_amazonAPIPriceFormatter",function(d,g,f,a){return d.createClass({init:function(c){this._priceFormatter=new a(c)},formatPrices:function(a){f.registerWidgetBodyBegin(g.METRIC_SCOPE_NAME.AAPI_PRICE_FORMATTER);try{this._formatPricesRec(a),f.registerWidgetCriticalFeature(g.METRIC_SCOPE_NAME.AAPI_PRICE_FORMATTER)}catch(d){throw d;
}finally{f.registerWidgetLoaded(g.METRIC_SCOPE_NAME.AAPI_PRICE_FORMATTER)}},_formatPricesRec:function(a){if(this._isPriceObject(a))a.displayString=this._formatPrice(a.amount,a.currencyCode,a.displayString);else if("object"===typeof a)for(var f in a)a.hasOwnProperty(f)&&this._formatPricesRec(a[f])},_isPriceObject:function(a){return"object"===typeof a&&this._priceFormatter.isValidPrice(a.amount,a.currencyCode)},_formatPrice:function(a,f,d){return"string"===typeof d&&0<d.length?d:this._priceFormatter.format(a,
f)}})});"use strict";p.when("A","abPricingFfqp_constants","abPricingFfqp_metrics").register("abPricingFfqp_priceFormatter",function(d,g,f){return d.createClass({init:function(a){a=a||{};this._priceFormat=a.priceFormat;this._decimalSeparator=a.decimalSeparator;this._fractionDigits=parseInt(a.fractionDigits);this._groupingSeparator=a.groupingSeparator;this._groupingDigits=parseInt(a.groupingDigits);this._secondaryGroupingDigits=parseInt(a.secondaryGroupingDigits);this._minGroupingDigits=parseInt(a.minGroupingDigits);
this._currencyCode=a.currencyOfPreference;this._validateInput();0===this._secondaryGroupingDigits&&(this._secondaryGroupingDigits=this._groupingDigits)},format:function(a,c){a=parseFloat(a);isNaN(a)&&this._throwValidationError("amount");if(0>a)return"-"+this.format(-a,c);a=this._formatAmount(a);return this._currencyFormat(c).replace("{}",a)},isValidPrice:function(a,c){a=parseFloat(a);return!isNaN(a)&&0<=a&&this._isValidCurrencyCode(c)},_validateInput:function(){this._validatePriceFormat();this._validateSeparator("decimalSeparator",
this._decimalSeparator);this._validateSeparator("groupingSeparator",this._groupingSeparator);this._validateDigitsCount("fractionDigits",this._fractionDigits,0);this._validateDigitsCount("groupingDigits",this._groupingDigits,0);this._validateDigitsCount("secondaryGroupingDigits",this._secondaryGroupingDigits,0);this._validateDigitsCount("minGroupingDigits",this._minGroupingDigits,1);this._validateCurrencyCode()},_validatePriceFormat:function(){"string"===typeof this._priceFormat&&-1!==this._priceFormat.indexOf("{}")||
this._throwValidationError("priceFormat")},_validateSeparator:function(a,c){"string"===typeof c&&0!==c.length||this._throwValidationError(a)},_validateDigitsCount:function(a,c,f){("number"!==typeof c||isNaN(c)||c<f)&&this._throwValidationError(a)},_validateCurrencyCode:function(){this._isValidCurrencyCode(this._currencyCode)||this._throwValidationError("currencyOfPreference")},_isValidCurrencyCode:function(a){return"string"===typeof a&&/^[A-Z]{3}$/.test(a)},_throwValidationError:function(a){throw Error("[abPricingFfqp_priceFormatter] Invalid value for "+
a);},_formatAmount:function(a){var c=this._halfEvenRound(a,this._fractionDigits).toString().split(".");a=this._formatIntegerPart(c[0]);if(0===this._fractionDigits)return a;c=this._formatDecimalPart(2===c.length?c[1]:"");return[a,c].join(this._decimalSeparator)},_halfEvenRound:function(a,c){a*=Math.pow(10,c);var f=a%1;a=.500001<=f||1E-6>Math.abs(f-.5)&&1===Math.floor(a)%2?Math.ceil(a):Math.floor(a);return a/Math.pow(10,c)},_formatIntegerPart:function(a){if(0===this._groupingDigits||a.length<this._groupingDigits+
this._minGroupingDigits)return a;for(var c=a.length,f=!0,d=[];0<c;){var g=this._secondaryGroupingDigits;f&&(f=!1,g=this._groupingDigits);c<g?d.push(a.substr(0,c)):d.push(a.substr(c-g,g));c-=g}return d.reverse().join(this._groupingSeparator)},_formatDecimalPart:function(a){for(;a.length<this._fractionDigits;)a+="0";return a.substr(0,this._fractionDigits)},_currencyFormat:function(a){if(a===this._currencyCode)return this._priceFormat;this._isValidCurrencyCode(a)||this._throwValidationError("currencyCode");
f.registerCounter(g.COUNTER_METRIC.FALLBACK_PRICE_FORMAT_USED);return a+" {}"}})});"use strict";p.register("abPricingFfqp_constants",function(){return{PACKAGE_PREFIX:"ABPricingFreeFormQuantityPicker",METRIC_SCOPE_NAME:{AAPI_PRICE_FORMATTER:"b2b-ffqp-aapi-price-formatter",AAPI_CLIENT:"b2b-ffqp-aapi-client-{clientId}",AAPI_QPT:"b2b-ffqp-aapi-qpt",AAPI_PACK_ASIN:"b2b-ffqp-aapi-pack-asin",AAPI_SINGLE_QUANTITY:"b2b-ffqp-aapi-single-quantity",AUI_STATE_PARSING:"b2b-ffqp-aui-state-parsing",GET_QPT_REQUEST:"b2b-ffqp-get-qpt-request"},
COUNTER_METRIC:{FALLBACK_PRICE_FORMAT_USED:"ABPricingFreeFormQuantityPicker.FallbackPriceFormatUsed",AAPI_REQUEST_STATUS:"ABPricingFreeFormQuantityPicker.AAPIClient.{clientId}.status.{status}",AAPI_SINGLE_QUANTITY_BO_NOT_FOUND:"ABPricingFreeFormQuantityPicker.AAPISingleQuantityBONotFound",AAPI_SINGLE_QUANTITY_EXTRACTION_FAILED:"ABPricingFreeFormQuantityPicker.AAPISingleQuantityBONotFoundExtractionFailed",AAPI_PACK_ASIN_EXTRACTION_FAILED:"ABPricingFreeFormQuantityPicker.AAPIPackAsinExtractionFailed",
AAPI_PACK_ASIN_BO_NOT_FOUND:"ABPricingFreeFormQuantityPicker.AAPIPackAsinBONotFound",AAPI_PACK_ASIN_MISSING:"ABPricingFreeFormQuantityPicker.AAPIPackAsinMissing",AAPI_PACK_ASIN_MISSING_BO:"ABPricingFreeFormQuantityPicker.AAPIPackAsinMissing.{bo}",AAPI_PACK_ASIN_ERROR:"ABPricingFreeFormQuantityPicker.AAPIPackAsinError",AAPI_PACK_ASIN_ERROR_CODE:"ABPricingFreeFormQuantityPicker.AAPIPackAsinError.{code}",AAPI_PACK_ASIN_PRESENT:"ABPricingFreeFormQuantityPicker.AAPIPackAsinPresent",AAPI_QPT_BO_NOT_FOUND:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableBONotFound",
AAPI_QPT_MISSING:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableMissing",AAPI_QPT_MISSING_BO:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableMissing.{bo}",AAPI_QPT_ERROR:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableError",AAPI_QPT_ERROR_CODE:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableError.{code}",AAPI_QPT_PRESENT:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePresent",AAPI_QPT_PAGINATES:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginates",
AAPI_QPT_FETCH_PAGE:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableFetchPage",AAPI_QPT_PAGE_FETCHED:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePageFetched",AAPI_QPT_PAGINATION_COMPLETE:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginationComplete",AAPI_QPT_NEXT_PAGE_ONLY:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableNextPageOnly",AAPI_QPT_PAGE_MISSING:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginationPageMissing",AAPI_QPT_EXTRACTION_FAILED:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableExtractionFailed",
AAPI_QPT_CONVERSION_ERROR:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableConversionFailed",AAPI_QPT_PAGINATION_PAGE_ERROR:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginationPageError",AAPI_QPT_PAGINATION_ERROR:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginationError",AAPI_QPT_PAGINATION_404_ERROR:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePagination404Error",AAPI_QPT_PAGINATION_404_EXCEPTION:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePagination404Exception",
AAPI_QPT_MAX_PAGINATION_DEPTH_REACHED:"ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginationDepthReached",AAPI_QPT_WEBLABS_TRIGGERING_EXCEPTION:"ABPricingFreeFormQuantityPicker.WeblabTriggeringException",AAPI_SUBRESOURCE_WEBLABS_TRIGGERING_EXCEPTION:"ABPricingFreeFormQuantityPicker.SubresourceWeblabTriggeringException",AAPI_DATA_MGR_INIT_FAILED:"ABPricingFreeFormQuantityPicker.AAPIDataManagerInitializationFailed",PACK_ASIN_RECOMMENDATION_ERROR:"ABPricingFreeFormQuantityPicker.PackAsinRecommendationError",
QUANTITY_REFRESH_CHECK_ERROR:"ABPricingFreeFormQuantityPicker.QuantityRefreshCheckError",PAGE_WILL_REFRESH:"ABPricingFreeFormQuantityPicker.PageWillRefresh",NO_PAGE_REFRESH_QTY_AVAILABLE:"ABPricingFreeFormQuantityPicker.NoPageRefreshQtyAvailable",NO_PAGE_REFRESH_QTY_NOT_AVAILABLE:"ABPricingFreeFormQuantityPicker.NoPageRefreshQtyNotAvailable",AVAILABILITY_CHECK_QTY_AVAILABLE_SHOULD_REFRESH:"ABPricingFreeFormQuantityPicker.AvailabilityCheckQtyAvailableShouldRefresh",AVAILABILITY_CHECK_PAGE_WILL_REFRESH:"ABPricingFreeFormQuantityPicker.AvailabilityCheckPageWillRefresh",
AVAILABILITY_CHECK_QTY_AVAILABLE_NO_REFRESH:"ABPricingFreeFormQuantityPicker.AvailabilityCheckQtyAvailableNoRefresh",AVAILABILITY_CHECK_QTY_AVAILABLE:"ABPricingFreeFormQuantityPicker.AvailabilityCheckQtyAvailable",OPTIMIZER_POPOVER_DISPLAYED:"ABPricingFreeFormQuantityPicker.OptimizerPopoverDisplayed",OPTIMIZER_BOTTOM_SHEET_DISPLAYED:"ABPricingFreeFormQuantityPicker.OptimizerBottomSheetDisplayed",AVAILABILITY_CHECK_QTY_NOT_AVAILABLE:"ABPricingFreeFormQuantityPicker.AvailabilityCheckQtyNotAvailable",
AVAILABILITY_CHECK_ERROR:"ABPricingFreeFormQuantityPicker.AvailabilityCheckError",MISSING_AJAX_PARAMS:"ABPricingFreeFormQuantityPicker.MissingAjaxParams",SPLIT_OFFER_LINK_DISPLAYED:"SplitOfferLinkDisplayed"},ERROR:{AAPI_DATA_MGR_INIT_FAILED:"AAPIDataManager initialization failed",MISSING_AJAX_PARAMS:"AAPIDataManager could not find the AJAX parameters"},AAPI_CLIENT_ID_PLACEHOLDER:"{clientId}",AAPI_METADATA_EXPERIMENTS:"x-api-exp-data",AAPI_REQUEST_STATUS_PLACEHOLDER:"{status}",AAPI_ERROR_CODE_PLACEHOLDER:"{code}",
AAPI_BO_PLACEHOLDER:"{bo}",UNSPECIFIED_CLIENT_ID:"unspecified",UNSPECIFIED_REQUEST_STATUS:"unspecified",AAPI_CLIENT_TIMEOUT:6E3,AJAX_PARAMS_STATE_KEY:"quantityPickerAjaxParams",MAX_SUPPORTED_QTY:999,MAX_PAGINATION_DEPTH:10,ADD_TO_CART_QUANTITY_CHANGE_EVENT:"addToCartQuantityChange",URL_PARAM_ID__BUYING_IN_BULK_QUANTITY:"quantity",URL_PARAM_ID__BUYING_IN_BULK_REFTAG:"ref_",URL_PARAM_ID__BUYING_IN_BULK_ASIN:"asin",URL_PARAM_VALUE__LIMITED_AVAILABILITY_REFTAG:"bbt_limit_order",WEBLAB_AUTOTRIGGER_ALLOWLIST:["AB_SAVINGS_STANDARDIZATION_EXPERIMENT_868536",
"B2BHAWKS_QPT_PAGE_LIMIT_DATAPATH_1033347","AB_DPX_OPTIMIZER_EXPERIMENT_1056062"]}});"use strict";p.when("jQuery","abPricingFfqp_constants","ready").register("abPricingFfqp_metrics",function(d,l){function f(c){a.isEnabled&&g.ue&&g.ue.count&&g.ue.count(c,(g.ue.count(c)||0)+1)}var a={isEnabled:!0};return{logError:function(a,f,d){g.ueLogError&&(a={logLevel:a,attribution:l.PACKAGE_PREFIX},d?a.message=f+" ":d={message:f},g.ueLogError(d,a))},register:function(a){a.counter&&f(a.counter)},registerCounter:f,
registerWidgetBodyBegin:function(c){a.isEnabled&&g.uet&&g.uet("bb",c,{wb:1})},registerWidgetCriticalFeature:function(c){a.isEnabled&&g.uet&&g.uet("cf",c,{wb:1})},registerWidgetLoaded:function(c){a.isEnabled&&g.uex&&g.uex("ld",c,{wb:1})},triggerWeblabIfAllowlisted:function(a,f){l.WEBLAB_AUTOTRIGGER_ALLOWLIST.includes(a)&&g.ue&&g.ue.trigger&&g.ue.trigger(a,f)}}});"use strict";p.when("jQuery","A","abPricingFfqp_utils","abPricingFfqp_constants","abPricingFfqp_metrics","abPricingFfqp_quantityPickerDataManager").register("abPricingFfqp_quantityManager",
function(d,l,f,a,c,k){function m(e,a){return(e=(new RegExp("(?:^|\\?|\x26)"+a+"\x3d(?:([^\x26#]*)|\x26|#|$)")).exec(e))?e[1]?decodeURIComponent(e[1].replace(/\+/g," ")):"":r}function n(e,a,b){var h=e.split("#");e=h[0];e="?"===e[0]?e.substr(1):e;h=h[1];"undefined"!==typeof b&&null!==b?(b=a+"\x3d"+b,a=new RegExp("(^|\x26)("+a+"\x3d[^\x26]*)"),e=a.test(e)?e.replace(a,"$1"+b):e+((0!==e.length?"\x26":"")+b)):(a=new RegExp("(^|\x26)("+a+"\x3d[^\x26]*)"),a.test(e)&&(e=e.replace(a,""),"\x26"===e[0]&&(e=e.substr(1))));
return"?"+e+("undefined"!==typeof h?"#"+h:"")}function q(e,a){for(var b in a)a.hasOwnProperty(b)&&(e=n(e,encodeURIComponent(b),encodeURIComponent(a[b])));return e}function h(e){return g.location.protocol+"//"+g.location.host+g.location.pathname+q(g.location.search,e)}function b(){var e;e=parseInt(m(g.location.search,"qty"));e=isNaN(e)||1>e||e>a.MAX_SUPPORTED_QTY?1:e;this._initialQuantity=this.currentQuantity=e;this.wireUpSelectorBasedEvents()}l.on("ready",function(){g.location.search.includes("\x26bmsmSlotRedirect\x3d1")&&
document.getElementById("qtyUpdatedTooltip").click()});b.prototype.getCurrentQuantity=function(){return this.currentQuantity};b.prototype.wireUpSelectorBasedEvents=function(){var e=this;p.when("A","jQuery","quanityChangePriceUpdate").execute(function(a,b,h){e.quantityChangePriceUpdater=h;a.on("a:pageUpdate",function(){e.handleTwisterPageRefresh()})})};b.prototype.update3PPriceBlock=function(){if(!(this.leastMinimumOrderQuantity===r||1>=this.leastMinimumOrderQuantity)){var e=d(".price3P");e.hasClass("updatedPrice3P")||
(e.addClass("updatedPrice3P"),this.quantityChangePriceUpdater.ajaxCall({qt:this.leastMinimumOrderQuantity,quantityPriceField:"quantity_price"}))}};b.prototype.handleTwisterPageRefresh=function(){this.update3PPriceBlock()};b.prototype.reloadPageForQuantity=function(e,a){var b={},f="";b.qty=e;b.psc=1;e="";"undefined"!==typeof a&&("undefined"!==typeof a.refTag&&(b.ref_=a.refTag),"string"===typeof a.selectedBuyingOption&&0<a.selectedBuyingOption.length&&(b.sbo=a.selectedBuyingOption),"undefined"!==typeof a.merchantId&&
(b.smid=a.merchantId),"undefined"!==typeof a.anchorToDiv&&(e=a.anchorToDiv),"undefined"!==typeof a.asinDetailPageUrl&&(f=g.location.protocol+"//"+g.location.host+a.asinDetailPageUrl+q("",b)+"\x26bmsmSlotRedirect\x3d1"+e));0===f.length&&(f=h(b)+e);g.location.href=f};b.prototype.notifyQuantityTyped=function(e,b){this.quantityRefreshCheck({newQuantity:e,currentBuyBoxId:b.currentBuyBoxId,qdsForLockedMerchantEnabled:b.qdsForLockedMerchantEnabled,success:function(e,h){c.registerCounter(e?a.COUNTER_METRIC.AVAILABILITY_CHECK_QTY_AVAILABLE:
a.COUNTER_METRIC.AVAILABILITY_CHECK_QTY_NOT_AVAILABLE);b.callback({hasAvailability:e})},error:function(){c.registerCounter(a.COUNTER_METRIC.AVAILABILITY_CHECK_ERROR);b.callback({hasAvailability:!0})}})};b.prototype.buyboxRefreshCheck=function(e){var b=this;this.quantityRefreshCheck({newQuantity:e.newQuantity,currentBuyBoxId:e.currentBuyBoxId,qdsForLockedMerchantEnabled:e.qdsForLockedMerchantEnabled,startEvent:"quantityRefreshCheckStarted",success:function(h,f){e.newQuantity===b.currentQuantity&&(h&&
f?(c.registerCounter(a.COUNTER_METRIC.PAGE_WILL_REFRESH),b.reloadPageForQuantity(e.newQuantity,{activeBuyBoxId:e.activeBuyBoxId,selectedBuyingOption:e.selectedBuyingOption})):(c.registerCounter(h?a.COUNTER_METRIC.NO_PAGE_REFRESH_QTY_AVAILABLE:a.COUNTER_METRIC.NO_PAGE_REFRESH_QTY_NOT_AVAILABLE),e.callback({hasAvailability:h})),l.trigger("quantityRefreshCheckFinished"))},error:function(){c.registerCounter(a.COUNTER_METRIC.QUANTITY_REFRESH_CHECK_ERROR);e.newQuantity===b.currentQuantity&&b.reloadPageForQuantity(e.newQuantity,
{activeBuyBoxId:e.activeBuyBoxId,selectedBuyingOption:e.selectedBuyingOption})}})};b.prototype.notifyQuantityChanged=function(e,a){e=parseInt(e);if(this.currentQuantity!==e){this.currentQuantity=e;if(g.history!==r&&g.history.pushState!==r){var b={};b.qty=e;g.history.pushState({},"",h(b))}l.trigger("buyBoxQuantityChanged",a.senderId,e,{newQuantity:e,activeBuyBoxId:a.activeBuyBoxId,selectedBuyingOption:a.selectedBuyingOption});l.trigger("notifyBuyingInBulkOptionClicked",e)}};b.prototype.quantityRefreshCheck=
function(e){if(!0!==e.preventRefreshCheck){var a={asin:f.getPageState().asin,initialQuantity:this._initialQuantity,quantity:e.newQuantity,currentBuyBoxId:e.currentBuyBoxId,success:e.success,error:e.error};if(e.qdsForLockedMerchantEnabled){var b=m(g.location.search,"smid");"undefined"!==typeof b&&(a.merchantId=b)}"string"===typeof e.startEvent&&l.trigger(e.startEvent);k.getInstance().refreshCheck(a)}};b.prototype.fetchAllTiersForQuantityDiscountTable=function(e){var a=this.isQPTBuyBoxAwareEnabled(e),
b={asin:f.getPageState().asin,enableQPTPagination:"true"};a&&(b.currentBuyBoxId=e.activeBuyBoxId);if(e.qdsForLockedMerchantEnabled){var h=m(g.location.search,"smid");"undefined"!==typeof h&&(b.merchantId=h)}h=e.enableQuantityPricingTablePagination;"undefined"!==h&&(b.enableQPTPagination=!1===h?"false":"true");var c=this;this.triggerBuyBoxAwareEvent("fetchQuantityDiscountTableStarted",e);b.success=function(b){a?l.trigger("fetchQuantityDiscountTableCompleted",b,e.senderId):l.trigger("fetchQuantityDiscountTableCompleted",
b)};b.error=function(){c.triggerBuyBoxAwareEvent("fetchQuantityDiscountTableError",e)};k.getInstance().getQuantityPricingTable(b)};b.prototype.isQPTBuyBoxAwareEnabled=function(e){return e&&e.senderId&&e.activeBuyBoxId};b.prototype.triggerBuyBoxAwareEvent=function(e,a){this.isQPTBuyBoxAwareEnabled(a)?l.trigger(e,a.senderId):l.trigger(e)};b.prototype.notifyBuyingInBulkOptionClicked=function(e){l.trigger("notifyBuyingInBulkOptionClicked",e)};b.prototype.getLimitedAvailabilityUrl=function(e){var b={};
b[a.URL_PARAM_ID__BUYING_IN_BULK_QUANTITY]=e;b[a.URL_PARAM_ID__BUYING_IN_BULK_ASIN]=f.getPageState().asin;b[a.URL_PARAM_ID__BUYING_IN_BULK_REFTAG]=a.URL_PARAM_VALUE__LIMITED_AVAILABILITY_REFTAG;return"/ab/bulk-order/bebx/api/v2/fastForwardBasket"+q("?",b)};b.prototype.notifyQuantityUnavailableOptionClicked=function(e){e=g.location.protocol+"//"+g.location.host+this.getLimitedAvailabilityUrl(e);g.location.href=e};return{EVENT__BUY_BOX_QUANTITY_CHANGED:"buyBoxQuantityChanged",EVENT__QUANTITY_REFRESH_CHECK_STARTED:"quantityRefreshCheckStarted",
EVENT__QUANTITY_REFRESH_CHECK_FINISHED:"quantityRefreshCheckFinished",EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_STARTED:"fetchQuantityDiscountTableStarted",EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_COMPLETED:"fetchQuantityDiscountTableCompleted",EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_ERROR:"fetchQuantityDiscountTableError",EVENT__NOTIFY_BUYING_IN_BULK_OPTION_CLICKED:"notifyBuyingInBulkOptionClicked",getUrlParameter:m,replaceUrlParameter:n,replaceUrlQueryParameters:function(e,a){var b="?";e=e.split(b);2===e.length&&
(b+=e[1]);a=q(b,a);"?"!==a&&(e[0]+=a);return e[0]},singleton:new b}});"use strict";p.when("A","jQuery","abPricingFfqp_constants","abPricingFfqp_metrics","abPricingFfqp_amazonAPIClient","abPricingFfqp_helpers","ready").register("abPricingFfqp_quantityPickerDataManager",function(d,g,f,a,c,k){var m=d.createClass({_buyboxIdToBOTypes:{customOffer:["CUSTOM_OFFER"],b2bRd:["B2B_RD"],default:["NEW","B2B_NEW"]},_buyboxIdToFallbackBOTypes:{customOffer:["NEW","B2B_NEW"]},init:function(a){this._aapiClient=new c(a);
this._qptCache=this._getQPTCacheInstance();this._quantityDataCache=this._getQuantityDataCacheInstance()},getQuantityPricingTable:function(h){a.registerWidgetBodyBegin(f.METRIC_SCOPE_NAME.GET_QPT_REQUEST);var b=this;this._qptCache.get(h,function(e){try{var c,d=b._extractQPT(e,h),g=b._extractPricingTiers(d);if(b._hasNextPage(d)){a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_PAGINATES);a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_FETCH_PAGE);var k=b._extractNextPage(d);b._aapiQPTRequest({asin:h.asin,nextPageUrl:k,
pricingTiersPages:[g],onSuccess:h.success,onError:h.error})}else c=b._convertToLegacyFormat(g),h.success(c)}catch(l){a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_EXTRACTION_FAILED),a.logError("ERROR","Exception during requesting quantity pricing table:",l),h.error(l)}},h.error)},refreshCheck:function(a){function b(e){c||(c=!0,a.error(e))}var e=this,f={},c=!1;g.each([a.quantity,a.initialQuantity],function(c,d){e._getSingleQuantityData({asin:a.asin,merchantId:a.merchantId,quantity:d,currentBuyBoxId:a.currentBuyBoxId,
success:function(e){f[d]=e;if(f[a.initialQuantity]&&f[a.quantity]){e=f[a.initialQuantity];var b=f[a.quantity];a.success(b.isAvailable,e.price!==b.price||e.buyingOptionId!==b.buyingOptionId)}},error:b})})},_aapiRequest:function(h){a.registerWidgetBodyBegin(h.metricScopeName);this._aapiClient.productV2({asin:h.asin,subresources:h.subresources,parameters:h.parameters,success:function(b){a.registerWidgetCriticalFeature(h.metricScopeName);a.registerWidgetLoaded(h.metricScopeName);h.onSuccess(b)},error:function(b,
e){a.registerWidgetLoaded(h.metricScopeName);h.onError(b,e)}})},_triggerQPTWeblabsIfAllowlisted:function(h){if(h.metadata&&h.metadata[f.AAPI_METADATA_EXPERIMENTS])try{h.metadata[f.AAPI_METADATA_EXPERIMENTS].split(",").forEach(function(b){b=b.split(":",2);a.triggerWeblabIfAllowlisted(b[0],b[1])})}catch(b){a.logError("ERROR","Could not trigger weblabs",b),a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_WEBLABS_TRIGGERING_EXCEPTION)}},_aapiQPTRequest:function(h){var b=this;this._aapiClient.productQPT({asin:h.asin,
url:h.nextPageUrl,success:function(e){try{var c=b._processQPTPage(e);h.pricingTiersPages.push(b._extractPricingTiers(c));a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_PAGE_FETCHED);b._maxPaginationDepthGuardrail(h.pricingTiersPages.length);if(b._hasNextPage(c)){a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_FETCH_PAGE);var d=b._extractNextPage(c);b._aapiQPTRequest({asin:h.asin,nextPageUrl:d,pricingTiersPages:h.pricingTiersPages,onSuccess:h.onSuccess,onError:h.onError})}else{var g=b._constructTiers(h.pricingTiersPages),
k=b._convertToLegacyFormat(g);a.registerWidgetCriticalFeature(f.METRIC_SCOPE_NAME.GET_QPT_REQUEST);a.registerWidgetLoaded(f.METRIC_SCOPE_NAME.GET_QPT_REQUEST);a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_PAGINATION_COMPLETE);h.onSuccess(k)}}catch(l){a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_PAGINATION_PAGE_ERROR),a.logError("ERROR","Exception when processing next page",l),h.onError(l)}},error:function(e,c,d){if(404===d){a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_PAGINATION_404_ERROR);try{var g=
b._constructTiers(h.pricingTiersPages),k=b._convertToLegacyFormat(g);a.registerWidgetCriticalFeature(f.METRIC_SCOPE_NAME.GET_QPT_REQUEST);a.registerWidgetLoaded(f.METRIC_SCOPE_NAME.GET_QPT_REQUEST);h.onSuccess(k)}catch(l){a.registerWidgetLoaded(f.METRIC_SCOPE_NAME.GET_QPT_REQUEST),a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_PAGINATION_404_EXCEPTION),a.logError("ERROR","Exception when processing empty page",l),h.onError(l)}}else a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_PAGINATION_ERROR),h.onError(e,
c)}})},_maxPaginationDepthGuardrail:function(h){if(h>=this.getMaxPaginationDepth())throw a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_MAX_PAGINATION_DEPTH_REACHED),Error("Max pagination depth reached");},getMaxPaginationDepth:function(){return f.MAX_PAGINATION_DEPTH},_getQPTCacheInstance:function(){var a=this,b=[a._aapiClient.inclusions().quantityPricingTableV1];return new k.AsyncCache({loader:function(e,c,d){var g={};"string"===typeof e.merchantId&&(g.merchantId=e.merchantId);g.enableQuantityPricingTablePagination=
e.enableQPTPagination;a._aapiRequest({asin:e.asin,subresources:b,parameters:g,onSuccess:c,onError:d,metricScopeName:f.METRIC_SCOPE_NAME.AAPI_QPT})},keyGenerator:function(e){var a=e.asin;"string"===typeof e.merchantId&&(a+=e.merchantId);return a}})},_getQuantityDataCacheInstance:function(){var a=this,b=[a._aapiClient.inclusions().priceV1,a._aapiClient.inclusions().availabilityV2];return new k.AsyncCache({loader:function(e,c,d){var g={itemQuantity:e.quantity};"string"===typeof e.merchantId&&(g.merchantId=
e.merchantId);a._aapiRequest({asin:e.asin,subresources:b,parameters:g,onSuccess:c,onError:d,metricScopeName:f.METRIC_SCOPE_NAME.AAPI_SINGLE_QUANTITY})},keyGenerator:function(a){var b=a.asin+a.quantity.toString();"string"===typeof a.merchantId&&(b+=a.merchantId);return b}})},_firstBuyingOption:function(a){return a.entity.buyingOptions[0]},_firstBuyingOptionByType:function(a,b){a=a.entity.buyingOptions;for(var e=0;e<a.length;e++){var c=a[e];if(-1!==b.indexOf(c.type))return c}},_firstBuyingOptionByBuyboxId:function(a,
b){a=this._firstBuyingOptionByType(a,this._buyboxIdToBOTypes[b]||this._buyboxIdToBOTypes.default);if("undefined"===typeof a)throw Error("Could not find an eligible buying option");return a},_firstBuyingOptionByBuyboxIdWithFallback:function(a,b){var e=this._buyboxIdToFallbackBOTypes[b];b=this._firstBuyingOptionByType(a,this._buyboxIdToBOTypes[b]||this._buyboxIdToBOTypes.default);"undefined"===typeof b&&"undefined"!==typeof e&&(b=this._firstBuyingOptionByType(a,e));if("undefined"===typeof b)throw Error("Could not find an eligible or fallback buying option");
return b},_extractQPT:function(c,b){var e;try{e=this._firstBuyingOptionByBuyboxId(c,b.currentBuyBoxId)}catch(d){a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_BO_NOT_FOUND);a.logError("ERROR","Exception when getting first BO",d);return}c=e.quantityPricingTable;if("undefined"===typeof c||"undefined"===typeof c.entity)a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_MISSING),"string"===typeof e.type&&a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_MISSING_BO.replace(f.AAPI_BO_PLACEHOLDER,e.type));else return this._triggerQPTWeblabsIfAllowlisted(c),
c},_processQPTPage:function(c){if("undefined"===c.entity)a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_PAGE_MISSING);else return c},_extractPricingTiers:function(c){if("undefined"===typeof c)return[];var b=c.entity.pricingTiers;if("undefined"===typeof b&&this._hasNextPage(c))return a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_NEXT_PAGE_ONLY),[];if("undefined"===typeof b)throw a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_ERROR),c=c.entity.code,"string"===typeof c&&a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_ERROR_CODE.replace(f.AAPI_ERROR_CODE_PLACEHOLDER,
c)),Error("Error in the QPT sub-resource");a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_PRESENT);return b},_hasNextPage:function(a){return"undefined"!==typeof a&&"undefined"!==typeof a.entity.nextPage},_extractNextPage:function(a){return a.entity.nextPage.resource.url},_constructTiers:function(a){for(var b=0,e=[],c=0;c<a.length;c++)for(var f=0;f<a[c].length;f++){var d=a[c][f],g=d.minimumQuantity;g!==b&&(b=g,e.push(d))}return e},_convertToLegacyFormat:function(c){var b=[];try{for(var e=0;e<c.length;e++){var d=
c[e],g={quantity:d.minimumQuantity,quantityPickerPriceText:k.richContentHelper.toText(d.priceMessage),isUncompetitive:d.hidden,isLowestAvailablePrice:d.lowestAvailablePrice};d.savingsMessage&&(g.savingsMessage=k.richContentHelper.toText(d.savingsMessage));d.availabilityMessage&&(g.availabilityMessage=k.richContentHelper.toText(d.availabilityMessage));d.program&&(g.program=d.program);d.buyingInBulk&&"undefined"!==typeof d.buyingInBulk.fragments&&1<=d.buyingInBulk.fragments.length&&(g.buyingInBulkLink=
k.richContentHelper.toText(d.buyingInBulk.fragments[0]),g.buyingInBulkMessage=k.richContentHelper.toText({fragments:d.buyingInBulk.fragments.slice(1)}));b.push(g)}}catch(l){throw a.registerCounter(f.COUNTER_METRIC.AAPI_QPT_CONVERSION_ERROR),l;}return b},_extractSingleQuantityData:function(c,b){var e={isAvailable:!1,buyingOptionId:"",price:""},d;try{d=this._firstBuyingOptionByBuyboxIdWithFallback(c,b)}catch(g){return a.registerCounter(f.COUNTER_METRIC.AAPI_SINGLE_QUANTITY_BO_NOT_FOUND),a.logError("ERROR",
"Exception during extracting single quantity data:",g),e}try{return{isAvailable:"OUT_OF_STOCK"!==d.availability.entity.type,buyingOptionId:d.availability.resource.url,price:d.price.entity.priceToPay.moneyValueOrRange.value.displayString}}catch(g){return a.registerCounter(f.COUNTER_METRIC.AAPI_SINGLE_QUANTITY_EXTRACTION_FAILED),e}},_getSingleQuantityData:function(a){var b=this;b._quantityDataCache.get({asin:a.asin,merchantId:a.merchantId,quantity:a.quantity},function(e){a.success(b._extractSingleQuantityData(e,
a.currentBuyBoxId))},a.error)}}),n=d.createClass({init:function(a){this._errorMessage=a},getQuantityPricingTable:function(a){a.error&&a.error(this._errorMessage)},refreshCheck:function(a){a.error&&a.error(this._errorMessage)}}),q;return{getInstance:function(){if("undefined"!==typeof q)return q;var c=d.state(f.AJAX_PARAMS_STATE_KEY);"undefined"===typeof c&&(a.registerWidgetBodyBegin(f.METRIC_SCOPE_NAME.AUI_STATE_PARSING),d.state.parse(),a.registerWidgetLoaded(f.METRIC_SCOPE_NAME.AUI_STATE_PARSING),
c=d.state(f.AJAX_PARAMS_STATE_KEY));if("undefined"!==typeof c){c.priceFormatConfig=c;c.clientId="dpx";try{q=new m(c)}catch(b){a.registerCounter(f.COUNTER_METRIC.AAPI_DATA_MGR_INIT_FAILED),q=new n(f.ERROR.AAPI_DATA_MGR_INIT_FAILED)}}else return a.registerCounter(f.COUNTER_METRIC.MISSING_AJAX_PARAMS),new n(f.ERROR.MISSING_AJAX_PARAMS);return q}}});"use strict";p.when("A").register("abPricingFfqp_helpers",function(d){var g=d.createClass({_listeners:{},addListeners:function(d,a,c){this._listeners.hasOwnProperty(d)||
(this._listeners[d]=[]);this._listeners[d].push({success:a,error:c})},triggerSuccess:function(d,a){this._triggerListeners(d,"success",a)},triggerError:function(d,a){this._triggerListeners(d,"error",a)},_triggerListeners:function(d,a,c){if(this._listeners.hasOwnProperty(d))for(d=this._listeners[d];0<d.length;){var g=d.pop();if(g[a])g[a](c)}}});return{AsyncCache:d.createClass({_requestStatus:{IN_PROGRESS:1,READY:2,ERROR:3},_status:{},_cache:{},init:function(d){this._eventHandler=new g;this._loader=
d.loader;this._keyGenerator=d.keyGenerator},_getKey:function(d){return this._keyGenerator?this._keyGenerator(d):d},get:function(d,a,c){var g=this._getKey(d);this._status[g]===this._requestStatus.READY?a(this._cache[g]):(this._eventHandler.addListeners(g,a,c),this._load(d,g))},_load:function(d,a){var c=this;c._status[a]!==c._requestStatus.IN_PROGRESS&&(c._status[a]=c._requestStatus.IN_PROGRESS,c._loader(d,function(d){c._cache[a]=d;c._status[a]=c._requestStatus.READY;c._eventHandler.triggerSuccess(a,
d)},function(d){c._status[a]=c._requestStatus.ERROR;c._eventHandler.triggerError(a,d)}))}}),richContentHelper:{toText:function a(c){if(c.money)return c.money.displayString;if(c.text)return c.text;if(c.link)return a(c.link.content);if(c.fragments){for(var d=[],g=0;g<c.fragments.length;g++)d.push(a(c.fragments[g]));return d.join("")}return c.semanticContent?a(c.semanticContent.content):""}}}});"use strict";p.when("jQuery","A","a-dropdown","a-button","abPricingFfqp_utils","abPricingFfqp_quantityManager",
"abPricingFfqp_metrics","abPricingFfqp_constants").register("abPricingFfqp_quantityPickerLogic",function(d,g,f,a,c,k,m,n){function q(a){return a.prop("selectedIndex")+1===a.prop("length")}function h(a,b){if(!c.dropdownContainsQuantity(a,b)){var d=document.createElement("option");d.value=b;d.text=b.toString();a.append(d)}}function b(a){this.id=a.id;this.buyBoxId=a.buyBoxId;this.buyingOptionStereotype=a.buyingOptionStereotype?a.buyingOptionStereotype:"";this.quantityHiddenFieldSelector=a.quantityHiddenFieldSelector;
this.leastMinimumOrderQuantity=a.leastMinimumOrderQuantity;this.predefinedQuantitiesDropdownSelector=a.predefinedQuantitiesDropdownSelector;this.predefinedQuantitiesDropdownContainerSelector=a.predefinedQuantitiesDropdownContainerSelector;this.freeQuantityTextInputSelector=a.freeQuantityTextInputSelector;this.freeQuantityTextInputOuterSelector=a.freeQuantityTextInputOuterSelector;this.updateButtonSelector=a.updateButtonSelector;this.addToCartButtonSelector=a.addToCartButtonSelector;this.buyingOptionPosition=
a.buyingOptionPosition;this.limitedAvailabilityMessageSelector=a.limitedAvailabilityMessageSelector;this.splitOfferLinkSelector=a.splitOfferLinkSelector;this.splitOfferSectionSelector=a.splitOfferSectionSelector;this.amazonDevicesLinkEnabled=a.amazonDevicesLinkEnabled;this.buyingInBulkBaseUrl=a.buyingInBulkBaseUrl;this.initializeQuantityHiddenField();this.wireUpSelectorBasedEvents()}b.prototype.wireUpSelectorBasedEvents=function(){var a=this,b=d(this.predefinedQuantitiesDropdownSelector);g.on("a:dropdown:"+
b[0].id+":select",function(b){a.handleDropdownOptionClicked(b.value)});g.on(k.EVENT__BUY_BOX_QUANTITY_CHANGED,function(b,d,c){a.handleQuantityChangedOnOtherBuyBox(b,d,c)});g.on(k.EVENT__QUANTITY_REFRESH_CHECK_STARTED,function(){a.handleQuantityRefreshCheckStarted()});g.on(k.EVENT__QUANTITY_REFRESH_CHECK_FINISHED,function(){a.handleQuantityRefreshCheckFinished()})};b.prototype.wireUpReferenceBasedEvents=function(){var a=this,b=d(this.freeQuantityTextInputSelector),c=d(this.updateButtonSelector);b.keydown(function(b){a.handleTextInputKeyDown(b)});
b.keyup(function(b){a.handleTextInputKeyUp(b)});b.focus(function(){a.handleTextInputFocused()});c.click(function(){a.handleButtonClick()})};b.prototype.attachToDOM=function(){this.wireUpReferenceBasedEvents();q(d(this.predefinedQuantitiesDropdownSelector))?this.switchToFreeQuantityUI():this.switchToPredefinedQuantitiesUI();this.enableUI();this.lastSelectedQuantity=this.getCurrentQuantity();k.singleton.leastMinimumOrderQuantity=this.leastMinimumOrderQuantity};b.prototype.getCurrentQuantity=function(){if(this.isTextInputVisible()){var a=
d(this.freeQuantityTextInputSelector);return parseInt(a.val())}return this.isDropdownVisible()?(a=d(this.predefinedQuantitiesDropdownSelector),parseInt(a.find(":selected").val())):r};b.prototype.handleQuantityRefreshCheckStarted=function(){this.doesDOMExist()&&this.disableUI()};b.prototype.handleQuantityRefreshCheckFinished=function(){this.doesDOMExist()&&this.enableUI()};b.prototype.handleDropdownOptionClicked=function(a){var b=d(this.predefinedQuantitiesDropdownSelector);q(b)?(a=d(this.freeQuantityTextInputSelector),
a.val(this.lastSelectedQuantity.toString()),this.switchToFreeQuantityUI(),a.focus(),c.incrementMetricByOne("freeFormQtyPickerMaxQtySelected")):(this.lastSelectedQuantity=a=parseInt(a),this.updateQuantityHiddenField(a),k.singleton.notifyQuantityChanged(a,{senderId:this.id,activeBuyBoxId:this.buyBoxId,selectedBuyingOption:this.buyingOptionStereotype}))};b.prototype.handleTextInputFocused=function(){d(this.freeQuantityTextInputSelector).select()};b.prototype.handleTextInputKeyUp=function(b){13!==b.keyCode&&
a(this.updateButtonSelector).show()};b.prototype.handleTextInputKeyDown=function(a){13===a.keyCode&&(a.preventDefault(),d(this.updateButtonSelector).click(),this._findWithinPickerAccordionRow(this.addToCartButtonSelector).focus())};b.prototype.clampQuantity=function(a){999<a&&(a=999);this.leastMinimumOrderQuantity!==r&&a<this.leastMinimumOrderQuantity&&(a=this.leastMinimumOrderQuantity);return a};b.prototype.handleButtonClick=function(){var b=d(this.predefinedQuantitiesDropdownSelector),g=f.getSelect(b[0]),
h=d(this.freeQuantityTextInputSelector),l=h.val(),m=parseInt,n=l.match(/[1-9][0-9]*/),m=m(null===n?"1":n[0]),m=this.clampQuantity(m);c.dropdownContainsQuantity(b,m)?(this.switchToPredefinedQuantitiesUI(),g.setValue(m.toString()),this.handleDropdownOptionClicked(m)):(b=m.toString(),b!==l&&h.val(b),a(this.updateButtonSelector).hide(),this.updateQuantityHiddenField(m),k.singleton.notifyQuantityChanged(m,{senderId:this.id,activeBuyBoxId:this.buyBoxId,selectedBuyingOption:this.buyingOptionStereotype}))};
b.prototype.doesDOMExist=function(){return 0<d(this.predefinedQuantitiesDropdownSelector).length&&0<d(this.freeQuantityTextInputSelector).length&&0<d(this.updateButtonSelector).length};b.prototype.handleQuantityChangedOnOtherBuyBox=function(a,b,d){if(this.doesDOMExist()){a!==this.id&&this.getCurrentQuantity()!==b&&this._updateSelectedQuantity(b);var c=this;k.singleton.buyboxRefreshCheck({newQuantity:b,activeBuyBoxId:d.activeBuyBoxId,selectedBuyingOption:d.selectedBuyingOption,currentBuyBoxId:this.buyBoxId,
callback:function(a){c.updateLimitedAvailabilityMessageVisibility(a.hasAvailability)}})}};b.prototype._updateSelectedQuantity=function(a){var b=d(this.predefinedQuantitiesDropdownSelector),g=f.getSelect(b[0]);c.dropdownContainsQuantity(b,a)?(g.setValue(a.toString()),this.lastSelectedQuantity=a,this.switchToPredefinedQuantitiesUI()):(d(this.freeQuantityTextInputSelector).val(a.toString()),this.switchToFreeQuantityUI());this.updateQuantityHiddenField(a)};b.prototype.showDropdown=function(){d(this.predefinedQuantitiesDropdownContainerSelector).removeClass("aok-hidden")};
b.prototype.hideDropdown=function(){d(this.predefinedQuantitiesDropdownContainerSelector).addClass("aok-hidden")};b.prototype.isDropdownVisible=function(){return!d(this.predefinedQuantitiesDropdownContainerSelector).hasClass("aok-hidden")};b.prototype.showTextInput=function(){"mobile"===c.getPageState().platform?d(this.freeQuantityTextInputOuterSelector).removeClass("aok-hidden"):d(this.freeQuantityTextInputSelector).removeClass("aok-hidden")};b.prototype.hideTextInput=function(){"mobile"===c.getPageState().platform?
d(this.freeQuantityTextInputOuterSelector).addClass("aok-hidden"):d(this.freeQuantityTextInputSelector).addClass("aok-hidden")};b.prototype.isTextInputVisible=function(){return"mobile"===c.getPageState().platform?!d(this.freeQuantityTextInputOuterSelector).hasClass("aok-hidden"):!d(this.freeQuantityTextInputSelector).hasClass("aok-hidden")};b.prototype.disableTextInput=function(){if("mobile"===c.getPageState().platform){var a=d(this.freeQuantityTextInputSelector),b=d(this.freeQuantityTextInputOuterSelector);
a.prop("disabled","disabled");b.addClass("a-form-disabled")}else a=d(this.freeQuantityTextInputSelector),a.prop("disabled","disabled"),a.addClass("a-form-disabled")};b.prototype.enableTextInput=function(){if("mobile"===c.getPageState().platform){var a=d(this.freeQuantityTextInputSelector),b=d(this.freeQuantityTextInputOuterSelector);a.removeProp("disabled");b.removeClass("a-form-disabled")}else a=d(this.freeQuantityTextInputSelector),a.removeProp("disabled"),a.removeClass("a-form-disabled")};b.prototype.switchToFreeQuantityUI=
function(){this.hideDropdown();this.showTextInput();a(this.updateButtonSelector).hide()};b.prototype.switchToPredefinedQuantitiesUI=function(){this.showDropdown();this.hideTextInput();a(this.updateButtonSelector).hide()};b.prototype.disableUI=function(){var b=f.getSelect(this.predefinedQuantitiesDropdownSelector),d=a(this.updateButtonSelector);b.update({status:"disabled"});this.disableTextInput();d.disable()};b.prototype.enableUI=function(){var b=f.getSelect(this.predefinedQuantitiesDropdownSelector),
d=a(this.updateButtonSelector);b.update({status:"normal"});this.enableTextInput();d.enable()};b.prototype._isMobileQuantityHiddenFieldSelector=function(){return"string"===typeof this.quantityHiddenFieldSelector&&-1<this.quantityHiddenFieldSelector.indexOf("select#mobileQuantityDropDown")};b.prototype._mobileQuantityHiddenFieldSelector=function(){return this.quantityHiddenFieldSelector.replace("input#quantity","select#mobileQuantityDropDown")};b.prototype.updateQuantityHiddenField=function(a){var b=
this._findWithinPickerAccordionRow(this.quantityHiddenFieldSelector).first();b.is("select")?(h(b,a),f.getSelect(b).val(a)):b.val(a.toString());g.trigger(n.ADD_TO_CART_QUANTITY_CHANGE_EVENT,{nativeItemNode:b[0],value:a.toString()});"mobile"!==c.getPageState().platform||this._isMobileQuantityHiddenFieldSelector()||(b=this._findWithinPickerAccordionRow(this._mobileQuantityHiddenFieldSelector()))&&b.is("select")&&(h(b,a),f.getSelect(b).val(a),b.val(a.toString()))};b.prototype.updateLimitedAvailabilityMessageVisibility=
function(b){var c=this._findWithinPickerAccordionRow(this.addToCartButtonSelector).closest(".a-button"),f=a(c),c=this._findWithinPickerAccordionRow(this.splitOfferSectionSelector);b?(d(this.limitedAvailabilityMessageSelector).addClass("aok-hidden"),f.enable(),c.addClass("aok-hidden")):(d(this.limitedAvailabilityMessageSelector).removeClass("aok-hidden"),f.disable(),b=this.getCurrentQuantity(),f=this.amazonDevicesLinkEnabled?this.buyingInBulkBaseUrl:k.singleton.getLimitedAvailabilityUrl(b),this._findWithinPickerAccordionRow(this.splitOfferLinkSelector).attr("href",
f),1<b?(m.registerCounter(n.COUNTER_METRIC.SPLIT_OFFER_LINK_DISPLAYED),c.removeClass("aok-hidden")):c.addClass("aok-hidden"))};b.prototype._findWithinPickerAccordionRow=function(a){return c.findWithinPickerAccordionRow(this.id,a)};b.prototype.initializeQuantityHiddenField=function(){var a=k.singleton.currentQuantity,b=parseInt(this.leastMinimumOrderQuantity);b&&b>a&&(a=b);this.updateQuantityHiddenField(a)};return{QuantityPickerLogic:b}});"use strict";p.when("jQuery","A","a-dropdown","a-modal","a-button",
"abPricingFfqp_utils","abPricingFfqp_quantityManager","abPricingFfqp_metrics","abPricingFfqp_constants").register("abPricingFfqpV2_quantityPickerLogic",function(d,l,f,a,c,k,m,n,q){function h(a,b){if(!k.dropdownContainsQuantity(a,b)){var d=document.createElement("option");d.value=b;d.text=b.toString();a.append(d)}}function b(a){this.id=a.id;this.buyBoxId=a.buyBoxId;this.buyingOptionStereotype=a.buyingOptionStereotype?a.buyingOptionStereotype:"";this.quantityHiddenFieldSelector=a.quantityHiddenFieldSelector;
this.leastMinimumOrderQuantity=a.leastMinimumOrderQuantity;this.quantityPickerSelector=a.quantityPickerSelector;this.quantityDiscountTableSelector=this.quantityPickerSelector+" .quantity-discount-table";this.quantityTextInputLabelSelector=this.quantityPickerSelector+" .quantity-text-input-label";this.buyboxAccordionContainerSelector=a.buyboxAccordionContainerSelector;this.loadMoreMessage=a.loadMoreMessage;this.fetchTheBestPricesMessage=a.fetchTheBestPricesMessage;this.qdtErrorMessage=a.qdtErrorMessage;
this.includeRfqdLinkInNewPicker=a.includeRfqdLinkInNewPicker;this.requestForQuantityDiscountModalSelector=a.requestForQuantityDiscountModalSelector;this.requestForQuantityDiscountMessage=a.requestForQuantityDiscountMessage;this.requestForQuoteLinkEnabled=a.requestForQuoteLinkEnabled;this.bbtLinkSelector=a.bbtLinkSelector;this.addToCartButtonSelector=a.addToCartButtonSelector;this.limitedAvailabilityMessageSelector=a.limitedAvailabilityMessageSelector;this.fetchQuantityDiscountTableCompleted=this.fetchQuantityDiscountTableStarted=
this.isLoadMoreButtonClicked=!1;this.quantityTextInputSelector=this.quantityPickerSelector;this.quantityTextInputSelector+=" .quantity-text-input-with-label";this.loadMoreButtonForUncompetitiveTiersPresence=this.hasError=!1;this.quantityPricingTableSummaryEnabled=a.quantityPricingTableSummaryEnabled;this.qdsForLockedMerchantEnabled=a.qdsForLockedMerchantEnabled;this.isAODLinkEnabled=!0===a.isAODLinkEnabled;this.quantityPickerUnavailabilityMessage=a.quantityPickerUnavailabilityMessage;this.quantityPickerUnavailabilityLink=
a.quantityPickerUnavailabilityLink;this.splitOfferLinkSelector=a.splitOfferLinkSelector;this.splitOfferSectionSelector=a.splitOfferSectionSelector;this.amazonDevicesLinkEnabled=a.amazonDevicesLinkEnabled;this.buyingInBulkBaseUrl=a.buyingInBulkBaseUrl;this.initializeQuantityAvailabilityVariables();this.wireUpSelectorBasedEvents();this.initializeQuantityHiddenField()}var e=k.PACKAGE_PREFIX+".PriceTableLoadError",p=k.PACKAGE_PREFIX+".QuantityPriceTableRender",u=k.PACKAGE_PREFIX+".QuantityPriceTableView",
v=k.PACKAGE_PREFIX+".QuantityPriceTableRenderWithLockedMerchant",w=k.PACKAGE_PREFIX+".QuantityPriceTableViewWithLockedMerchant",x=k.PACKAGE_PREFIX+".QuantityPriceTableRenderWithUncompetitiveTiers",y=k.PACKAGE_PREFIX+".QuantityPriceTableViewWithUncompetitiveTiers",z=k.PACKAGE_PREFIX+".QuantityPriceTableLoadMoreButtonClicked",A=k.PACKAGE_PREFIX+".QuantityPriceTableLoadMoreButtonClickedWithUncompetitiveTiers",B=k.PACKAGE_PREFIX+".QuantityPriceTableBBTLinkRender",C=k.PACKAGE_PREFIX+".QuantityPriceTableBBTLinkClick",
D=k.PACKAGE_PREFIX+".QuantityPriceTableQuantityUnavailableLinkRender",E=k.PACKAGE_PREFIX+".QuantityPriceTableQuantityUnavailableLinkClick",F=k.PACKAGE_PREFIX+".QuantityPriceTableRFQDBBTLinkClick",G=k.PACKAGE_PREFIX+".QuantityPriceTableAvailabilityMessageRender",H=k.PACKAGE_PREFIX+".QuantityPriceTableAvailabilityMessageView",I=k.PACKAGE_PREFIX+".QuantityPriceTablePerceivedError";b.prototype.initializeQuantityAvailabilityVariables=function(){this.hasAvailability=!0};b.prototype.wireUpSelectorBasedEvents=
function(){var a=this;l.on(m.EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_STARTED,function(b){b&&b!==a.id||a.handleFetchQuantityDiscountTableStarted()});l.on(m.EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_COMPLETED,function(b,d){d&&d!==a.id||a.handleFetchQuantityDiscountTableCompleted(b)});l.on(m.EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_ERROR,function(b){b&&b!==a.id||a.handleFetchQuantityDiscountTableError()});l.on(m.EVENT__BUY_BOX_QUANTITY_CHANGED,function(b,d,c){a.handleQuantityChangedOnOtherBuyBox(b,d,c)});l.on(m.EVENT__QUANTITY_REFRESH_CHECK_STARTED,
function(){a.handleQuantityRefreshCheckStarted()});l.on(m.EVENT__QUANTITY_REFRESH_CHECK_FINISHED,function(){a.handleQuantityRefreshCheckFinished()})};b.prototype.initializeQuantityHiddenField=function(){var a=m.singleton.currentQuantity,b=parseInt(this.leastMinimumOrderQuantity);b&&b>a&&(a=b);this.updateQuantityHiddenField(a)};b.prototype.handleFetchQuantityDiscountTableCompleted=function(a){this.wireUpQuantityDiscountTableData(a);this.generateQuantityDiscountTable();this.fetchQuantityDiscountTableCompleted=
!0};b.prototype.handleFetchQuantityDiscountTableStarted=function(){this.fetchQuantityDiscountTableStarted=!0};b.prototype.wireUpQuantityDiscountTableData=function(a){this.priceTiers=a;this.buildQptRenderMetrics();this.buildQptForLockedMerchantMetrics(v);this.buildQptUncompetitiveTiersMetrics(x);this.buildAvailabilityMessageMetrics(G)};b.prototype.handleFetchQuantityDiscountTableError=function(){k.incrementMetricByOne(e);this.fetchQuantityDiscountTableStarted=!1;this.hasError=!0;this.generateQuantityDiscountTable()};
b.prototype.wireUpReferenceBasedEvents=function(){var a=this,b=d(this.quantityTextInputSelector),c=d(this.quantityTextInputLabelSelector);c.click(function(){b.focus();b.click()});b.focus(function(){c.hide();"1"===this.value&&(this.value="");a.showQuantityDiscountTable()});b.blur(function(){""===this.value&&(this.value=m.singleton.currentQuantity);a.updateQuantityAndHideQuantityDiscountTable();c.show()});b.live("keypress input",function(b){a.isValidQuantityTextInputKeyCode(b);this.value=this.value.replace(/[^0-9]/g,
"")});b.live("input",l.throttle(function(b){a.quantityAvailabilityCheckStart()},500));b.live("keydown",function(b){a.isValidQuantityTextPressKeyCode(b)});b.live("click change paste keyup",function(){a.clampQuantity(b.val());a.generateQuantityDiscountTable()})};b.prototype.quantityAvailabilityCheckStart=function(){this.initializeQuantityAvailabilityVariables();var a=this.getCurrentQuantity(),b=this;m.singleton.notifyQuantityTyped(a,{currentBuyBoxId:this.buyBoxId,activeBuyBoxId:this.buyBoxId,selectedBuyingOption:this.buyingOptionStereotype,
qdsForLockedMerchantEnabled:this.qdsForLockedMerchantEnabled,callback:function(d){a===b.getCurrentQuantity()&&b.updateLimitedAvailabilityMessageVisibility(d.hasAvailability)}})};b.prototype.attachToDOM=function(){this.wireUpReferenceBasedEvents();this.enableUI();m.singleton.leastMinimumOrderQuantity=this.leastMinimumOrderQuantity};b.prototype.isValidQuantityTextPressKeyCode=function(a){var b={left:37,up:38,right:39,down:40},d=g.event?a.keyCode:a.which,c;for(c in b)b[c]===d&&a.preventDefault()};b.prototype.isValidQuantityTextInputKeyCode=
function(a){var b=g.event?a.keyCode:a.which;8!==b&&46!==b&&(13===b?(this.updateQuantityAndHideQuantityDiscountTable(),a.preventDefault()):(b=String.fromCharCode(b),/\d/.test(b)||a.preventDefault()))};b.prototype.getCurrentQuantity=function(){var a=d(this.quantityTextInputSelector);return this.clampQuantity(a.val())};b.prototype.handleQuantityRefreshCheckStarted=function(){this.doesDOMExist()&&this.disableUI()};b.prototype.handleQuantityRefreshCheckFinished=function(){this.doesDOMExist()&&this.enableUI()};
b.prototype.clampQuantity=function(a){var b=a;999<a&&(b=999);this.leastMinimumOrderQuantity!==r&&a<this.leastMinimumOrderQuantity&&(b=this.leastMinimumOrderQuantity);return b};b.prototype.doesDOMExist=function(){return 0<d(this.quantityTextInputSelector).length};b.prototype.handleQuantityChangedOnOtherBuyBox=function(a,b,c){if(this.doesDOMExist()){a!==this.id&&parseInt(this.getCurrentQuantity())!==b&&(d(this.quantityTextInputSelector).val(b),this.updateQuantityHiddenField(b));var e=this;m.singleton.buyboxRefreshCheck({newQuantity:b,
activeBuyBoxId:c.activeBuyBoxId,selectedBuyingOption:c.selectedBuyingOption,currentBuyBoxId:this.buyBoxId,qdsForLockedMerchantEnabled:this.qdsForLockedMerchantEnabled,callback:function(a){e.updateLimitedAvailabilityMessageVisibility(a.hasAvailability)}})}};b.prototype.showQuantityDiscountTable=function(){this.buildQptViewMetrics();this.hasError&&n.registerCounter(I);this.fetchQuantityDiscountTableCompleted&&(this.buildQptForLockedMerchantMetrics(w),this.buildQptUncompetitiveTiersMetrics(y,this.getStartIndexOfQuantityDiscountTierTable(),
3),this.buildAvailabilityMessageMetrics(H));var a=k.findAccordionRow(this.id);0<a.length&&(a.get(0).setAttribute("style","overflow:visible"),a=a.find(".a-accordion-inner.accordion-row-content"),0<a.length&&a.get(0).setAttribute("style","overflow:visible"));a=d(this.buyboxAccordionContainerSelector);0<a.length&&(a.get(0).setAttribute("style","overflow:visible"),a=a.find(".a-accordion-inner"),0<a.length&&a.get(0).setAttribute("style","overflow:visible"));d(this.quantityPickerSelector).addClass("open")};
b.prototype.hideQuantityDiscountTable=function(){d(this.quantityPickerSelector).removeClass("open")};b.prototype.updateQuantityAndHideQuantityDiscountTable=function(){var a=d(this.quantityDiscountTableSelector),b=d(this.quantityTextInputSelector),c=this.clampQuantity(b.val());b.val(c);this.updateQuantityHiddenField(c);m.singleton.notifyQuantityChanged(c,{senderId:this.id,activeBuyBoxId:this.buyBoxId,selectedBuyingOption:this.buyingOptionStereotype,qdsForLockedMerchantEnabled:this.qdsForLockedMerchantEnabled});
this.isLoadMoreButtonClicked=!1;this.hideQuantityDiscountTable();a.empty()};b.prototype.disableUI=function(){var a=d(this.quantityTextInputSelector),b=d(this.quantityDiscountTableSelector);a.attr("disabled",!0);a.addClass("quantity-text-input-disabled");b.attr("disabled",!0)};b.prototype.enableUI=function(){var a=d(this.quantityTextInputSelector),b=d(this.quantityDiscountTableSelector);a.attr("disabled",!1);a.removeClass("quantity-text-input-disabled");b.attr("disabled",!1);this.hideQuantityDiscountTable()};
b.prototype._isMobileQuantityHiddenFieldSelector=function(){return"string"===typeof this.quantityHiddenFieldSelector&&-1<this.quantityHiddenFieldSelector.indexOf("select#mobileQuantityDropDown")};b.prototype._mobileQuantityHiddenFieldSelector=function(){return this.quantityHiddenFieldSelector.replace("input#quantity","select#mobileQuantityDropDown")};b.prototype.updateQuantityHiddenField=function(a){var b=this._findWithinPickerAccordionRow(this.quantityHiddenFieldSelector).first();b.is("select")&&
(h(b,a),f.getSelect(b).val(a));b.val(a.toString());l.trigger(q.ADD_TO_CART_QUANTITY_CHANGE_EVENT,{nativeItemNode:b[0],value:a.toString()});"mobile"!==k.getPageState().platform||this._isMobileQuantityHiddenFieldSelector()||(b=this._findWithinPickerAccordionRow(this._mobileQuantityHiddenFieldSelector()))&&b.is("select")&&(h(b,a),f.getSelect(b).val(a),b.val(a.toString()))};b.prototype.generateVisibleTiersList=function(a,b){for(var c=[],d=0,e=!1;b<this.priceTiers.length&&(this.isLoadMoreButtonClicked||
3>d);){var f=this.priceTiers[b],g=!this.shouldHideFirstTier()&&0===d,h=f.isLowestAvailablePrice||e||2!==d;if(this.isLoadMoreButtonClicked||g||!f.isUncompetitive&&h)c.push({quantity:Math.max(a,f.quantity),savingsMessage:f.savingsMessage,availabilityMessage:f.availabilityMessage,quantityPickerPriceText:f.quantityPickerPriceText,isDiscountUnlocked:0===d?0===b&&"BUSINESS_VOLUME_AWARE_PRICING"===f.program:!1,isFirstTier:g}),e=e||f.isLowestAvailablePrice,d++;b++}return c};b.prototype.findStartIndexOfQuantityDiscountTierTable=
function(a){for(var b=0,d=this.priceTiers.length-1;b<=d;){var c=parseInt((b+d)/2),e;e=this.priceTiers[c].quantity;e=0===e.length?0:parseInt(e);if(e===a)return c;e>a?d=c-1:b=c+1}return Math.max(0,d)};b.prototype.getStartIndexOfQuantityDiscountTierTable=function(){var a=this.getCurrentQuantity(),a=this.findStartIndexOfQuantityDiscountTierTable(a);return this.shouldHideFirstTier()&&1<this.priceTiers.length?a+1:a};b.prototype.shouldHideFirstTier=function(){var a=m.singleton.currentQuantity,b=d(this.quantityTextInputSelector);
return!this.isAvailabilityMessagePresent()&&1===a&&""===b.val()};b.prototype.generateQuantityDiscountTable=function(){this.cleanOutQuantityDiscountTable();var a=d(this.quantityDiscountTableSelector);this.hasError?a.append(this.generateSingleTierDiscountTableUnorderedList(this.generateQdtErrorMessage())):this.hasAvailability?this.priceTiers===r?a.append(this.generateFetchInProcessTableUnorderedList()):0===this.priceTiers.length?a.append(this.generateSingleTierDiscountTableUnorderedList()):a.append(this.generateQuantityDiscountTableUnorderedList()):
a.append(this.generateQuantityUnavailableTableUnorderedList())};b.prototype.cleanOutQuantityDiscountTable=function(){d(this.quantityDiscountTableSelector).empty()};b.prototype.areUncompetitiveTiersPresent=function(a,b){var d=!1;if("undefined"!==typeof this.priceTiers)for("undefined"===typeof a&&(a=0),b="undefined"===typeof b?this.priceTiers.length:Math.min(a+b,this.priceTiers.length),a+=1;a<b;a++)if(this.priceTiers[a].isUncompetitive){d=!0;break}return d};b.prototype.isAvailabilityMessagePresent=
function(){return"undefined"!==typeof this.priceTiers&&0<this.priceTiers.length&&"undefined"!==typeof this.priceTiers[0].availabilityMessage};b.prototype.showLoadMoreButton=function(a){this.loadMoreButtonForUncompetitiveTiersPresence=this.areUncompetitiveTiersPresent(a);return!this.isLoadMoreButtonClicked&&(3<this.priceTiers.length-a||this.loadMoreButtonForUncompetitiveTiersPresence)};b.prototype.showBuyingInBulkLink=function(a){return"undefined"!==typeof this.priceTiers[a].buyingInBulkLink};b.prototype.generateQuantityDiscountTableUnorderedList=
function(){var a=this.getCurrentQuantity(),b=this.getStartIndexOfQuantityDiscountTierTable(),a=this.generateVisibleTiersList(a,b),c=document.createElement("ul");c.setAttribute("class","qdt-ul");for(var e=d(c),f=0;f<a.length;f++)e.append(this.generateQuantityDiscountTierOption(a[f]));this.showLoadMoreButton(b)?e.append(this.generateLoadMoreOption()):!this.showBuyingInBulkLink(b)||!0!==this.includeRfqdLinkInNewPicker&&"true"!==this.includeRfqdLinkInNewPicker?!0!==this.includeRfqdLinkInNewPicker&&"true"!==
this.includeRfqdLinkInNewPicker||e.append(this.generateRequestForQuantityDiscountOption()):e.append(this.generateBuyingInBulkOption(b));return c};b.prototype.generateSingleTierDiscountTableUnorderedList=function(a){var b=this.getCurrentQuantity(),b=this.generateSingleTierQuantityList(b),c=document.createElement("ul");c.setAttribute("class","qdt-ul");for(var e=d(c),f=0;f<b.length;f++)e.append(this.generateQuantityDiscountTierOption(b[f]));a&&e.append(a);return c};b.prototype.generateQuantityUnavailableTableUnorderedList=
function(){var a=document.createElement("ul");a.setAttribute("class","qdt-ul");d(a).append(this.generateQuantityUnavailableOption());return a};b.prototype.generateSingleTierQuantityList=function(a){var b=[];b.push({quantity:Math.max(a,1),savingsMessage:null,availabilityMessage:null,quantityPickerPriceText:"",isDiscountUnlocked:!1,isFirstTier:!0});return b};b.prototype.generateFetchInProcessTableUnorderedList=function(){var a=document.createElement("ul");a.setAttribute("class","qdt-ul");d(a).append(this.generateFetchInProcessOption());
return a};b.prototype._removeINRSymbol=function(a){a=a.split("\x3e");return a[a.length-1]};b.prototype._populateOptionPriceContent=function(a,b){if("string"===typeof a.quantityPickerPriceText&&-1!==a.quantityPickerPriceText.search("currencyINR")){var c=document.createElement("span");c.setAttribute("class","currencyINR");c.textContent="  ";b.appendChild(c);a=this._removeINRSymbol(a.quantityPickerPriceText);b.appendChild(document.createTextNode(a))}else b.textContent=a.quantityPickerPriceText};b.prototype.generateQuantityDiscountTierOption=
function(a){var b=this,c=document.createElement("li"),d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div");a.isFirstTier?(e.textContent=a.quantity,c.setAttribute("class","qdt-dropdown-item qdt-active")):(e.textContent=a.quantity+"+",c.setAttribute("class","qdt-dropdown-item"));b._populateOptionPriceContent(a,f);e.setAttribute("class","option-tier");f.setAttribute("class","option-price");a.availabilityMessage!==r?this.generateTierWithAvailabilityMessageContent(d,
e,f,a.availabilityMessage):a.savingsMessage!==r?this.generateTierWithSavingsMessageContent(d,e,f,a):(d.setAttribute("class","qdt-dropdown-option-no-saving-message"),d.appendChild(e),d.appendChild(f));c.appendChild(d);c.addEventListener("mousedown",function(){b.handleQuantityDiscountTableOptionClicked(a.quantity)});return c};b.prototype.generateTierWithAvailabilityMessageContent=function(a,b,c,d){var e=document.createElement("div");e.textContent=d;e.setAttribute("class","option-availability-message");
this.generateTierWithMessageContent(a,b,c,e)};b.prototype.generateTierWithSavingsMessageContent=function(a,b,c,e){var f=document.createElement("div");f.textContent=e.savingsMessage;e.isDiscountUnlocked?(e=document.createElement("div"),e.setAttribute("class","option-unlocked-saving-message-icon"),d(f).prepend(e),f.setAttribute("class","option-unlocked-saving-message")):f.setAttribute("class","a-color-tertiary option-saving-message");this.generateTierWithMessageContent(a,b,c,f)};b.prototype.generateTierWithMessageContent=
function(a,b,c,e){var d=document.createElement("div");a.setAttribute("class","qdt-dropdown-option-regular");d.setAttribute("class","option-price-and-message");d.appendChild(c);d.appendChild(e);a.appendChild(b);a.appendChild(d)};b.prototype.generateLoadMoreOption=function(){var a=this,b=document.createElement("li"),c=document.createElement("div");c.textContent=this.loadMoreMessage;b.setAttribute("class","qdt-dropdown-item");c.setAttribute("class","qdt-dropdown-option-load-more");b.setAttribute("id",
"qdt-dropdown-load-more");b.appendChild(c);b.addEventListener("mousedown",function(b){a.handleLoadMoreOptionClicked(b)});return b};b.prototype.generateRequestForQuantityDiscountOption=function(){var a=this,b=document.createElement("a");b.textContent=this.requestForQuantityDiscountMessage;b.setAttribute("class","a-link-normal qdt-dropdown-request-for-quantity-discount");b.addEventListener("mousedown",function(b){a.handleRequestForQuantityDiscountOptionClicked(b)});return this.generateLinkOption(b)};
b.prototype.generateBuyingInBulkOption=function(a){var b=this;a={container:{element:document.createElement("div"),class:"qdt-dropdown-buying-in-bulk"},link:{element:document.createElement("a"),class:"a-link-normal qdt-dropdown-buying-in-bulk-link",text:b.priceTiers[a].buyingInBulkLink},message:{element:document.createElement("div"),class:"qdt-dropdown-buying-in-bulk-message",text:b.priceTiers[a].buyingInBulkMessage}};for(var c in a)a.hasOwnProperty(c)&&(a[c].element.setAttribute("class",a[c].class),
"undefined"!==typeof a[c].text&&(a[c].element.textContent=a[c].text));a.container.element.appendChild(a.link.element);a.container.element.appendChild(a.message.element);a.link.element.addEventListener("mousedown",function(a){b.handleBuyingInBulkOptionClicked(b.bbtLinkSelector,C,a)});n.registerCounter(B);return this.generateLinkOption(a.container.element)};b.prototype.generateQuantityUnavailableOption=function(){var a=this,b=document.createElement("div"),c=document.createElement("div");c.innerHTML=
this.quantityPickerUnavailabilityMessage;b.setAttribute("class","a-link-normal qdt-dropdown-quantity-unavailable");c.setAttribute("class","qdt-dropdown-quantity-unavailable-message");b.appendChild(c);0<this._findWithinPickerAccordionRow(this.splitOfferSectionSelector).length&&(c=document.createElement("a"),c.textContent=this.quantityPickerUnavailabilityLink,c.setAttribute("class","a-link-normal qdt-dropdown-quantity-unavailable-link"),b.appendChild(c),c.addEventListener("mousedown",function(b){a.handleQuantityUnavailableOptionClicked(b)}));
n.registerCounter(D);return this.generateLinkOption(b)};b.prototype.generateLinkOption=function(a){var b=document.createElement("li"),c=document.createElement("div");b.setAttribute("class","qdt-dropdown-item qdt-inactive");c.setAttribute("class","qdt-dropdown-option-link");c.appendChild(a);b.appendChild(c);return b};b.prototype.generateFetchInProcessOption=function(){var a=document.createElement("li"),b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),
e=document.createElement("img");e.src="https://m.media-amazon.com/images/G/01/AmazonBusiness/vapLoading3._CB1556651073_.gif";c.textContent=this.fetchTheBestPricesMessage;e.setAttribute("class","fetching-in-progress-img");a.setAttribute("class","qdt-dropdown-item qdt-inactive");b.setAttribute("class","qdt-dropdown-option-fetch-in-progress");d.appendChild(e);b.appendChild(d);b.appendChild(c);a.setAttribute("id","qdt-dropdown-fetch-in-progress");a.appendChild(b);return a};b.prototype.generateQdtErrorMessage=
function(){var a=document.createElement("li"),b=document.createElement("div");if(this.isAODLinkEnabled){var c=document.createElement("span");c.setAttribute("class","a-declarative");c.setAttribute("data-action","show-all-offers-display");c.setAttribute("data-show-all-offers-display","{}");c.innerHTML=this.qdtErrorMessage;b.appendChild(c)}else b.innerHTML=this.qdtErrorMessage;a.setAttribute("class","qdt-dropdown-item qdt-inactive");b.setAttribute("class","qdt-dropdown-option-request-for-olp");a.setAttribute("id",
"qdt-dropdown-error-message");a.appendChild(b);var d=b.getElementsByTagName("a")[0];d.addEventListener("mousedown",function(a){d.click()});return a};b.prototype.handleLoadMoreOptionClicked=function(a){this.isLoadMoreButtonClicked=!0;this.buildLoadMoreButtonMetrics();this.generateQuantityDiscountTable();a.preventDefault()};b.prototype.handleQuantityDiscountTableOptionClicked=function(a){d(this.quantityTextInputSelector).val(a);this.updateQuantityAndHideQuantityDiscountTable();d(this.quantityTextInputLabelSelector).show()};
b.prototype.handleRequestForQuantityDiscountOptionClicked=function(b){var c=d(this.requestForQuantityDiscountModalSelector).find(".a-declarative");(c=a.get(c))&&c.show();this.handleBuyingInBulkOptionClicked(this.requestForQuantityDiscountModalSelector,F,b)};b.prototype.handleBuyingInBulkOptionClicked=function(a,b,c){var d=this.getCurrentQuantity();if(this.amazonDevicesLinkEnabled&&!this.requestForQuoteLinkEnabled)n.registerCounter(b),m.singleton.notifyBuyingInBulkOptionClicked(d),g.location.href=
this.buyingInBulkBaseUrl;else if(a=document.querySelector(a+" .a-link-normal"))n.registerCounter(b),m.singleton.notifyBuyingInBulkOptionClicked(d),a.click();c.preventDefault()};b.prototype.handleQuantityUnavailableOptionClicked=function(a){n.registerCounter(E);var b=this.getCurrentQuantity();this.quantityUnavailableOptionClicked(b);a.preventDefault()};b.prototype.quantityUnavailableOptionClicked=function(a){a=this.amazonDevicesLinkEnabled?this.buyingInBulkBaseUrl:g.location.protocol+"//"+g.location.host+
m.singleton.getLimitedAvailabilityUrl(a);g.location.href=a};b.prototype.updateLimitedAvailabilityMessageVisibility=function(a){this.hasAvailability=a;this.generateQuantityDiscountTable();this.updateBuyboxLimitedAvailabilityMessageVisibility()};b.prototype.updateBuyboxLimitedAvailabilityMessageVisibility=function(){var a=this._findWithinPickerAccordionRow(this.addToCartButtonSelector).closest(".a-button"),b=c(a),a=this._findWithinPickerAccordionRow(this.splitOfferSectionSelector);if(this.hasAvailability)d(this.limitedAvailabilityMessageSelector).addClass("aok-hidden"),
b.enable(),a.addClass("aok-hidden");else{d(this.limitedAvailabilityMessageSelector).removeClass("aok-hidden");b.disable();var b=this.getCurrentQuantity(),e;e=this.amazonDevicesLinkEnabled?this.buyingInBulkBaseUrl:m.singleton.getLimitedAvailabilityUrl(b);this._findWithinPickerAccordionRow(this.splitOfferLinkSelector).attr("href",e);1<b?(n.registerCounter(q.COUNTER_METRIC.SPLIT_OFFER_LINK_DISPLAYED),a.removeClass("aok-hidden")):a.addClass("aok-hidden")}};b.prototype.buildQptRenderMetrics=function(){var a=
{};a.counter=p+(this.quantityPricingTableSummaryEnabled?".QPTS":"");n.register(a)};b.prototype.buildQptViewMetrics=function(){var a={};a.counter=u+(this.quantityPricingTableSummaryEnabled?".QPTS":"");n.register(a)};b.prototype.buildQptForLockedMerchantMetrics=function(a){this.qdsForLockedMerchantEnabled&&n.registerCounter(a)};b.prototype.buildQptUncompetitiveTiersMetrics=function(a,b,c){this.areUncompetitiveTiersPresent(b,c)&&n.registerCounter(a)};b.prototype.buildLoadMoreButtonMetrics=function(){this.loadMoreButtonForUncompetitiveTiersPresence?
n.registerCounter(A):n.registerCounter(z)};b.prototype.buildAvailabilityMessageMetrics=function(a){this.isAvailabilityMessagePresent()&&n.registerCounter(a)};b.prototype._findWithinPickerAccordionRow=function(a){return k.findWithinPickerAccordionRow(this.id,a)};return{QuantityPickerLogicV2:b}});"use strict";p.when("jQuery","A","abPricingFfqp_constants","ready").execute(function(d,l,f){function a(a){g.ue!==r&&g.ue.count!==r&&g.ue.count(a,(g.ue.count(a)||0)+1)}function c(a,b,c){null===c&&(c="");var d=
new RegExp("\\b("+b+"\x3d).*?(\x26|#|$)");if(0<=a.search(d))return a.replace(d,"$1"+c+"$2");a=a.replace(/[?#]$/,"");return a+(0<a.indexOf("?")?"\x26":"?")+b+"\x3d"+c}function k(){return l.state(f.PACKAGE_PREFIX)}function m(a,b){return 0!==a.find('option[value\x3d"'+b.toString()+'"]').length}function n(a){return d("[id^\x3d"+a+"]").closest("[data-a-accordion-row-name]")}function q(a,b){a=n(a);return 0<a.length?a.find(b):d(b)}function h(){b||k()===r||(b=!0,p.register("abPricingFfqp_utils",function(){return{getPageState:k,
incrementMetricByOne:a,replaceUrlParam:c,dropdownContainsQuantity:m,findAccordionRow:n,findWithinPickerAccordionRow:q}}))}var b=!1;h();p.register("abPricingFfqp_lazyInitializer",function(){return{tryInitialize:h}})})});
/* ******** */
(function(c){var d=window.AmazonUIPageJS||window.P,f=d._namespace||d.attributeErrors,a=f?f("ABPricingQuantityPricingTableSummaryAssets",""):d;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,d,f){c.when("A","jQuery","abPricingFfqp_utils","abPricingFfqp_quantityManager","abPricingFfqp_metrics").execute(function(a,c,d,f,g){a.declarative("b2bhawks-quantity-pricing-table-summary-click","click",function(b){var a=b.data.selectedQuantity,e="",c=b.data.deviceType,d=b.data.bestTier,
k=b.data.recommendedTier,h=b.data.asinDetailPageUrl;if(!b.data.tierSelected){d&&k?g.registerCounter("AB_QR_QPTS_RECOMMENDED_AND_BEST_TIER"):k?g.registerCounter("AB_QR_QPTS_RECOMMENDED_TIER"):d?g.registerCounter("AB_QR_QPTS_BEST_TIER"):g.registerCounter("AB_QR_QPTS_DEFAULT_TIER");if("mobile"===c||"mobileApp"===c)e+="#b2bhawks-quantity-pricing-table-summary";e={anchorToDiv:e};e.selectedBuyingOption="undefined"!==typeof b.data.selectedBuyingOption&&0<b.data.selectedBuyingOption.length?b.data.selectedBuyingOption:
"RZvfv//HxDF+O5021pAnSA\x3d\x3d";h&&0!=h.length&&(e.asinDetailPageUrl=h,e.refTag="bmsm_slot_redirect");f.singleton.reloadPageForQuantity(a,e)}})})});
/* ******** */
